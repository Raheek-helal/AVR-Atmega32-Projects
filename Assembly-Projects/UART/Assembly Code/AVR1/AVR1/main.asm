;
; AVR1.asm
;
; Created: 10/22/2023 1:55:39 PM
; Author : Raheek-Hela
;


.INCLUDE <m32adef.inc>

; Replace with your application code
; initialize the stack pointer
init:
	LDI R16, LOW(RAMEND)
	OUT SPL,R16
	LDI R16, HIGH(RAMEND)
	OUT SPH,R16
	; intialize PORTA as an input
	LDI R16, $00
	OUT DDRA,R16
	; intialize PORTA as input PULL UP
	LDI R16, $FF
	OUT PORTA,R16
	; intialize PORTC0 as an output
	SBI DDRC,0

main:
	;SEND 0 FOR THE START BIT
	CBI PORTC, 0
	CALL DELAY
	CALL DELAY

	;READING THE PORTA AND SEND IT IN PORTC(PIN0)
	SBIS PINA, 0
	SBI  PORTC,0
	SBIC PINA, 0
	CBI  PORTC,0
	CALL DELAY
	CALL DELAY

	SBIS PINA, 1
	SBI  PORTC,0
	SBIC PINA, 1
	CBI  PORTC,0
	CALL DELAY
	CALL DELAY

	SBIS PINA, 2
	SBI  PORTC,0
	SBIC PINA, 2
	CBI  PORTC,0
	CALL DELAY
	CALL DELAY

	SBIS PINA, 3
	SBI  PORTC,0
	SBIC PINA, 3
	CBI  PORTC,0
	CALL DELAY
	CALL DELAY

	SBIS PINA, 4
	SBI  PORTC,0
	SBIC PINA, 4
	CBI  PORTC,0
	CALL DELAY
	CALL DELAY

	SBIS PINA, 5
	SBI  PORTC,0
	SBIC PINA, 5
	CBI  PORTC,0
	CALL DELAY
	CALL DELAY

	SBIS PINA, 6
	SBI  PORTC,0
	SBIC PINA, 6
	CBI  PORTC,0
	CALL DELAY
	CALL DELAY

	SBIS PINA, 7
	SBI  PORTC,0
	SBIC PINA, 7
	CBI  PORTC,0
	CALL DELAY
	CALL DELAY

	;SEND 1 FOR THE STOP BIT
	SBI PORTC,0
	CALL DELAY

	RJMP main

DELAY:
	LDI  R16,14 ; 1 cycle -> 42
LOOP: ; 6 in last loop
	DEC  R16  ; 1 cycle -> 41
	BRNE LOOP ; 2 cycle -> 39
	NOP
	NOP
RET ; 4